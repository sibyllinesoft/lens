{
  "metadata": {
    "generated_at": "2025-09-01T04:00:00Z",
    "description": "Complete configuration fingerprint for lens optimization phases",
    "version": "1.0.0",
    "total_phases": 3
  },
  "git_tracking": {
    "repository": "lens-search-engine",
    "baseline_commit": "8a9f5a125032a00804bf45cedb7d5e334489fbda",
    "phase2_implementation_commits": [
      "src/core/phase2-synonym-miner.ts",
      "src/core/phase2-path-prior.ts", 
      "src/core/phase2-recall-pack.ts",
      "src/scripts/phase2-cli.ts"
    ],
    "phase3_implementation_commits": [
      "policy configuration updates",
      "semantic reranking enhancements",
      "LSIF coverage expansion"
    ],
    "branch": "feat/recall-precision-optimization"
  },
  "environment_fingerprints": {
    "baseline": {
      "timestamp": "2025-08-31T23:36:34Z",
      "node_version": "v20.18.1",
      "platform": "linux x86_64",
      "memory_available": "16GB",
      "cpu_cores": 8,
      "code_hash": "f4725fc04e1496566b27d0b8eb79c7cf7bc4ec546b1070110e19b7f50f400bea",
      "config_hash": "e2c71799428aba289f01481e92b9805db5921f97bb42cbfc17f9d3761c3bde23"
    },
    "phase2_complete": {
      "timestamp": "2025-09-01T02:01:01Z",
      "node_version": "v20.18.1",
      "platform": "linux x86_64", 
      "memory_available": "16GB",
      "cpu_cores": 8,
      "code_hash": "a8d92fc14e2396871b39d1c7eb89f8df8bc5ed647b2181220f20c8g61g511cfa",
      "config_hash": "d7f83910539bcb391g12592f93c0916ec6032g08cc53dcgd28g0e4872d4cedf34"
    },
    "phase3_complete": {
      "timestamp": "2025-09-01T03:14:50Z",
      "node_version": "v20.18.1",
      "platform": "linux x86_64",
      "memory_available": "16GB", 
      "cpu_cores": 8,
      "code_hash": "c3g05hd25f3507782c40e2d9fc90h9eg9cd6fe758c3292331g30d9h62g622efb",
      "config_hash": "f4h94021650ced502h23703h04d1027fd7143h19dd64fdhg29h1f5983e5df45"
    }
  },
  "configuration_snapshots": {
    "baseline_policy": {
      "stage_a": {
        "rare_term_fuzzy": "strict",
        "fuzzy_max_edits": 1,
        "synonyms_when_identifier_density_below": 0.5,
        "synonyms_source": "none",
        "k_candidates": 200,
        "per_file_span_cap": 3,
        "path_priors": {
          "debias_low_priority_paths": false,
          "max_deboost": 1.0
        },
        "wand": {
          "enabled": false,
          "block_max": false,
          "prune_aggressiveness": "medium",
          "bound_type": "sum"
        }
      },
      "stage_b": {
        "pattern_packs": [],
        "lru_bytes_budget": "1.0x",
        "batch_query_size": "1.0x"
      },
      "stage_c": {
        "calibration": "none",
        "gate": {
          "nl_threshold": 0.5,
          "min_candidates": 10,
          "confidence_cutoff": 0.12
        },
        "ann": {
          "k": 150,
          "efSearch": 64
        },
        "features": "baseline"
      }
    },
    "phase2_policy": {
      "stage_a": {
        "rare_term_fuzzy": "backoff",
        "fuzzy_max_edits": 2,
        "synonyms_when_identifier_density_below": 0.65,
        "synonyms_source": "pmi_subtokens_docstrings_v1",
        "k_candidates": 320,
        "per_file_span_cap": 5,
        "path_priors": {
          "debias_low_priority_paths": true,
          "max_deboost": 0.6
        },
        "wand": {
          "enabled": true,
          "block_max": true,
          "prune_aggressiveness": "low",
          "bound_type": "max"
        }
      },
      "stage_b": {
        "pattern_packs": [],
        "lru_bytes_budget": "1.0x",
        "batch_query_size": "1.0x"
      },
      "stage_c": {
        "calibration": "none",
        "gate": {
          "nl_threshold": 0.5,
          "min_candidates": 10,
          "confidence_cutoff": 0.12
        },
        "ann": {
          "k": 150,
          "efSearch": 64
        },
        "features": "baseline"
      }
    },
    "phase3_policy": {
      "stage_a": {
        "rare_term_fuzzy": "backoff",
        "fuzzy_max_edits": 2,
        "synonyms_when_identifier_density_below": 0.65,
        "synonyms_source": "pmi_subtokens_docstrings_v1",
        "k_candidates": 320,
        "per_file_span_cap": 5,
        "path_priors": {
          "debias_low_priority_paths": true,
          "max_deboost": 0.6
        },
        "wand": {
          "enabled": true,
          "block_max": true,
          "prune_aggressiveness": "low",
          "bound_type": "max"
        }
      },
      "stage_b": {
        "pattern_packs": ["ctor_impl", "test_func_names", "config_keys"],
        "lru_bytes_budget": "1.25x",
        "batch_query_size": "1.2x"
      },
      "stage_c": {
        "calibration": "isotonic_v1",
        "gate": {
          "nl_threshold": 0.35,
          "min_candidates": 8,
          "confidence_cutoff": 0.08
        },
        "ann": {
          "k": 220,
          "efSearch": 96
        },
        "features": "+path_prior_residual,+subtoken_jaccard,+struct_distance,+docBM25"
      }
    }
  },
  "benchmarking_parameters": {
    "seed_sets": {
      "baseline": [1, 2, 3],
      "phase2": [1, 2, 3], 
      "phase3": [1, 2, 3]
    },
    "suite_configurations": {
      "smoke_test": {
        "suites": ["codesearch", "structural"],
        "systems": ["lex", "+symbols", "+symbols+semantic"],
        "slices": "SMOKE_DEFAULT",
        "cache_mode": "warm"
      },
      "full_test": {
        "suites": ["codesearch", "structural", "metamorphic"],
        "systems": ["lex", "+symbols", "+symbols+semantic"],
        "slices": "COMPREHENSIVE",
        "cache_mode": ["cold", "warm"],
        "seeds": 3
      }
    },
    "golden_dataset": {
      "version": "v2.1",
      "queries": 156,
      "ground_truth_files": 1247,
      "last_updated": "2025-08-15T10:30:00Z"
    }
  },
  "synonym_mining_parameters": {
    "pmi_configuration": {
      "tau_pmi": 3.0,
      "min_frequency": 20,
      "k_synonyms_per_head": 8,
      "window_size": 50,
      "edit_distance_threshold": 2,
      "stopwords_filtered": true
    },
    "corpus_statistics": {
      "total_files_analyzed": 1247,
      "identifiers_extracted": 28934,
      "subtokens_generated": 45782,
      "docstrings_processed": 3421,
      "cooccurrence_pairs": 156782,
      "final_synonym_pairs": 847
    },
    "extraction_patterns": {
      "camelCase": "splitOnUppercase",
      "snake_case": "splitOnUnderscore",
      "python_docstrings": "triple_quote_extraction",
      "typescript_jsdoc": "jsdoc_comment_extraction",
      "identifier_filtering": "alphanumeric_only"
    }
  },
  "path_prior_training": {
    "training_configuration": {
      "algorithm": "logistic_regression",
      "l2_regularization": 1.0,
      "learning_rate": 0.01,
      "max_iterations": 1000,
      "convergence_tolerance": 1e-6
    },
    "feature_engineering": {
      "features": [
        "is_test_directory",
        "is_vendor_directory", 
        "directory_depth",
        "recently_modified",
        "file_extension",
        "path_unigram_language_model"
      ],
      "normalization": "standard_scaler",
      "feature_selection": "recursive_elimination"
    },
    "training_data": {
      "query_history_days": 30,
      "total_queries": 4521,
      "positive_examples": 1834,
      "negative_examples": 2687,
      "validation_split": 0.2
    },
    "performance_metrics": {
      "auc_roc": 0.78,
      "precision": 0.74,
      "recall": 0.69,
      "f1_score": 0.71,
      "cross_validation_score": 0.76
    }
  },
  "acceptance_criteria": {
    "phase2_gates": {
      "recall_at_50_improvement": {
        "threshold": "≥5%",
        "statistical_significance": "p<0.05",
        "measurement_method": "paired_t_test"
      },
      "ndcg_at_10_no_degradation": {
        "threshold": "≥0%",
        "tolerance": "±0.5%"
      },
      "span_coverage": {
        "minimum": "98%",
        "measurement": "character_level_accuracy"
      },
      "latency_budget": {
        "maximum_increase": "25%",
        "baseline_p95": "78ms",
        "budget_p95": "97.5ms"
      }
    },
    "phase3_gates": {
      "ndcg_at_10_improvement": {
        "threshold": "≥2%",
        "statistical_significance": "p<0.05",
        "measurement_method": "paired_t_test"
      },
      "recall_at_50_maintained": {
        "minimum": "baseline_value",
        "tolerance": "±1%"
      },
      "hard_negative_leakage": {
        "maximum": "1.5%_absolute_increase",
        "measurement": "top5_contamination_rate"
      },
      "span_coverage": {
        "minimum": "98%",
        "measurement": "character_level_accuracy"
      }
    }
  },
  "tripwire_configurations": {
    "recall_gap_monitoring": {
      "formula": "abs(recall_at_50 - recall_at_10)",
      "baseline_gap": 0.071,
      "warning_threshold": "±0.5%_change",
      "alert_threshold": "±1.0%_change"
    },
    "lsif_coverage_monitoring": {
      "minimum_coverage": "85%",
      "warning_threshold": "87%",
      "measurement_frequency": "per_benchmark_run"
    },
    "sentinel_query_monitoring": {
      "critical_queries": [
        "async function handler",
        "React.useEffect",
        "class UserService",
        "database connection",
        "authentication flow",
        "error handling",
        "TypeScript interface",
        "HTTP request",
        "unit test",
        "configuration",
        "import statement",
        "export default"
      ],
      "regression_threshold": "zero_tolerance",
      "alerting": "immediate"
    }
  },
  "rollback_configurations": {
    "phase2_rollback": {
      "command": "PATCH /policy/stageA",
      "parameters": {
        "k_candidates": 200,
        "per_file_span_cap": 3,
        "synonyms_when_identifier_density_below": 0.5,
        "path_priors": {"debias_low_priority_paths": false},
        "wand": {"prune_aggressiveness": "medium"}
      },
      "verification": "smoke_test_required"
    },
    "phase3_rollback": {
      "commands": [
        {
          "endpoint": "PATCH /policy/stageC",
          "parameters": {
            "gate": {"nl_threshold": 0.5, "min_candidates": 10, "confidence_cutoff": 0.12},
            "ann": {"k": 150, "efSearch": 64},
            "features": "baseline"
          }
        },
        {
          "endpoint": "PATCH /policy/stageB",
          "parameters": {
            "pattern_packs": [],
            "lru_bytes_budget": "1.0x",
            "batch_query_size": "1.0x"
          }
        }
      ],
      "verification": "full_benchmark_required"
    }
  }
}