{
  "canary_promotion_approved": true,
  "readiness_checks": [
    {
      "name": "Ablation analysis complete",
      "passed": true
    },
    {
      "name": "Weak levers removed",
      "passed": true
    },
    {
      "name": "Configuration optimized",
      "passed": true
    },
    {
      "name": "Drift risk minimized",
      "passed": true
    }
  ],
  "deployment_plan": [
    {
      "phase": 1,
      "traffic": "5%",
      "duration": "30 minutes",
      "gates": [
        "error_rate < 0.1%",
        "p95_latency < 1.5x baseline",
        "recall_maintained"
      ],
      "monitoring": "High-frequency metrics collection"
    },
    {
      "phase": 2,
      "traffic": "25%",
      "duration": "2 hours",
      "gates": [
        "error_rate < 0.05%",
        "p95_latency < 1.3x baseline",
        "ndcg_maintained"
      ],
      "monitoring": "Full metrics dashboard + alerts"
    },
    {
      "phase": 3,
      "traffic": "100%",
      "duration": "Continuous",
      "gates": [
        "all_invariants_maintained",
        "quality_gates_green"
      ],
      "monitoring": "Production monitoring + weekly reviews"
    }
  ],
  "kill_switches": [
    {
      "trigger": "Error rate > 0.1% sustained for 5 minutes",
      "action": "Immediate rollback to previous policy version",
      "recovery": "Automatic traffic shift + policy revert"
    },
    {
      "trigger": "Recall@50 drops > 2% from baseline",
      "action": "Stage-A kill-switch activation",
      "recovery": "Disable recall enhancements, maintain precision"
    },
    {
      "trigger": "nDCG@10 drops > 3% from Phase 2 levels",
      "action": "Stage-C kill-switch activation",
      "recovery": "Revert to baseline semantic ranking"
    },
    {
      "trigger": "P95 latency > 2x baseline sustained",
      "action": "Full rollback + emergency scaling",
      "recovery": "Immediate revert to v1.0 baseline configuration"
    }
  ],
  "monitoring_config": {
    "metrics": [
      {
        "name": "recall_at_50",
        "threshold": "≥ 0.856",
        "alert": "critical"
      },
      {
        "name": "ndcg_at_10",
        "threshold": "≥ 0.743",
        "alert": "warning"
      },
      {
        "name": "error_rate",
        "threshold": "< 0.1%",
        "alert": "critical"
      },
      {
        "name": "p95_latency",
        "threshold": "< 1.5x baseline",
        "alert": "warning"
      },
      {
        "name": "span_coverage",
        "threshold": "≥ 98%",
        "alert": "critical"
      }
    ],
    "dashboards": [
      "Real-time quality gates dashboard",
      "Canary deployment progress tracker",
      "Historical performance comparison",
      "Kill-switch status and triggers"
    ],
    "alerts": [
      "Slack #lens-alerts for all critical thresholds",
      "PagerDuty for kill-switch activations",
      "Email digest for daily canary progress",
      "Dashboard notifications for gate changes"
    ]
  },
  "recommendation": {
    "status": "APPROVED",
    "confidence": "HIGH",
    "rationale": [
      "Weak levers successfully removed (drift surface reduced)",
      "87% of Phase 2 gains retained in optimized configuration",
      "Kill-switch procedures defined and tested",
      "Comprehensive monitoring and alerting in place",
      "Clear rollback procedures for all failure scenarios"
    ],
    "next_steps": [
      "Deploy optimized configuration to canary infrastructure",
      "Begin 5% traffic split with high-frequency monitoring",
      "Progress through canary phases based on gate status",
      "Maintain 24/7 monitoring during initial deployment",
      "Schedule weekly review meetings during rollout"
    ]
  },
  "optimized_configuration": {
    "version": "v1.2-optimized",
    "description": "Optimized configuration after ablation analysis - weak levers removed",
    "changes_from_baseline": {
      "stage_a": {
        "k_candidates": 320,
        "per_file_span_cap": 5,
        "wand": {
          "enabled": true,
          "block_max": true,
          "prune_aggressiveness": "low",
          "bound_type": "max"
        },
        "note": "Synonyms and path_priors removed due to weak contribution"
      },
      "stage_b": {
        "pattern_packs": [
          "ctor_impl",
          "test_func_names",
          "config_keys"
        ],
        "lru_bytes_budget": "1.25x",
        "batch_query_size": "1.2x",
        "note": "Kept - strong contribution to symbol coverage"
      },
      "stage_c": {
        "calibration": "isotonic_v1",
        "gate": {
          "nl_threshold": 0.35,
          "min_candidates": 8,
          "confidence_cutoff": 0.08
        },
        "ann": {
          "k": 220,
          "efSearch": 96
        },
        "features": "+path_prior_residual,+subtoken_jaccard,+struct_distance,+docBM25",
        "note": "Kept - primary driver of nDCG improvements"
      }
    },
    "removed_levers": [
      {
        "lever": "synonyms_when_identifier_density_below",
        "reason": "Minimum contribution 12.5% < 25% threshold",
        "impact_on_positives": "Weakest contribution to positives-in-candidates"
      },
      {
        "lever": "path_priors.debias_low_priority_paths",
        "reason": "Minimum contribution 5.0% < 25% threshold",
        "impact_on_ndcg": "Minimal contribution to nDCG improvements"
      }
    ],
    "expected_performance": {
      "recall_at_50": 0.895,
      "ndcg_at_10": 0.765,
      "positives_in_candidates": 21,
      "performance_retention": "87% of Phase 2 gains retained",
      "drift_reduction": "Significant reduction in configuration complexity"
    },
    "canary_readiness": {
      "configuration_complexity": "REDUCED",
      "feature_surface": "MINIMIZED",
      "drift_risk": "LOW",
      "rollback_confidence": "HIGH",
      "recommendation": "READY FOR CANARY"
    }
  },
  "timestamp": "2025-09-01T16:29:48.306Z"
}